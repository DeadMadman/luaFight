local map = {}

map.currentTiles = {}
map.tileSize = createVec(16, 16)
map.grid = {
    {40,40,90,40,51,40,90,51,40,90,40,40,51,40,40,40,90,90,51,40,40,40,40,93,51,40,40,40,90,40,40,40,51,93,40,40,40,40,51,90,40,51,40,40,},
    {51,51,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,40,40,},
    {40,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,51,},
    {40,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,90,},
    {90,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,40,},
    {51,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,90,},
    {40,52,0,0,0,0,0,0,0,0,0,0,0,0,0,7,73,7,7,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,40,},
    {51,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,40,},
    {93,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,40,},
    {40,9,7,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,51,},
    {51,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,73,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,50,51,},
    {40,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,40,},
    {40,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,93,},
    {40,52,0,0,0,0,0,0,7,73,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,90,},
    {51,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,51,},
    {51,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,40,},
    {90,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,73,7,7,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,40,},
    {40,9,7,7,7,73,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,51,},
    {90,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,40,},
    {40,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39,90,},
    {40,51,30,30,29,30,30,29,30,30,47,48,30,30,30,30,47,48,29,30,30,1,5,2,5,2,3,4,47,48,30,29,30,30,30,29,30,30,29,29,29,30,93,51,},
    {40,51,93,40,40,40,40,90,51,40,51,40,51,93,40,93,40,40,51,40,40,40,40,90,40,40,90,51,51,40,51,40,40,40,40,51,40,90,40,40,51,90,40,40,}
    } 

function map.createMap()
    require("tile")

    for rowIndex, row in ipairs(map.grid) do  
        for colIndex, type in ipairs(row) do
            if type > 0 then
                local pos = createVec((colIndex - 1) * map.tileSize.x, (rowIndex - 1) * map.tileSize.y)
                local newTile = createTile(pos.x, pos.y, map.tileSize.x, map.tileSize.y, type + 1)
                table.insert(map.currentTiles, newTile)
            end
        end
    end
end

function map.draw()
    for _, tile in pairs(map.currentTiles) do
        tile.drawTile(tile)
    end
end

function map.update(dt)
    for _, tile in pairs(map.currentTiles) do
        tile.updateTile(tile, dt)
    end
end

return map